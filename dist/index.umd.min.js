!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).nodeToDataURL=t()}(this,function(){"use strict";const e="___capture-show",t="___capture-hide",n="___force-overflow",o={customStyle:"",excludedNodes:[],returnType:"dataUrl",targetNode:document.body};let i=o;function r(o,r){!function(o){o.classList.add(e);let r=o.parentElement;for(const e of i.excludedNodes)e.classList.add(t);for(;r;)r.classList.add(n),r=r.parentElement}(o);const s=function(o){const r=document.head.cloneNode(!0),s=document.createElement("style");for(const e of Array.from(r.childNodes))e instanceof HTMLStyleElement||e.remove();s.innerText+="foreignObject>div {",s.innerText+="position: fixed;",s.innerText+=`top: ${window.outerHeight}px;`,s.innerText+="overflow: visible;",s.innerText+="}",s.innerText+=`.${e} {`,s.innerText+="position: fixed;",s.innerText+="left: 0;",s.innerText+="top: 0;",s.innerText+=`width: ${o.width}px;`,s.innerText+=`height: ${o.height}px;`,s.innerText+="}",s.innerText+=`.${t} {display: none !important;}`,s.innerText+=`.${n} {overflow: visible !important;}`,s.innerText+=i.customStyle,r.appendChild(s);let d="";for(const e of Array.from(r.querySelectorAll("style")))d+=e.outerHTML;return d}(r),d=document.body.innerHTML.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g,""),c=(r.left,r.top,document.createElementNS("http://www.w3.org/2000/svg","svg"));c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("height",r.height.toString()),c.setAttribute("width",r.width.toString());const l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.removeAttribute("xmlns"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("height",window.outerHeight.toString()),l.setAttribute("width",window.outerWidth.toString());const a=document.createElement("div");return a.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("class",document.body.className),a.innerHTML=d,l.appendChild(a),c.insertAdjacentHTML("afterbegin",s),c.appendChild(l),function(o){o.classList.remove(e);let r=o.parentElement;for(const e of i.excludedNodes)e.classList.remove(t);for(;r;)r.classList.remove(n),r=r.parentElement}(o),(new XMLSerializer).serializeToString(c)}return function(e){const t=(i=Object.assign(Object.assign({},o),e)).targetNode,n=t.getBoundingClientRect(),s=r(t,n),d=`data:image/svg+xml,${encodeURIComponent(s)}`,c=document.createElement("canvas");return new Promise((e,t)=>{if(!c)return void t();const o=document.createElement("img");o.addEventListener("error",()=>{c.remove(),t()}),o.addEventListener("load",()=>{c.width=n.width,c.height=n.height,c.getContext("2d").drawImage(o,0,0),e(c.toDataURL()),c.remove()}),o.src=d})}});