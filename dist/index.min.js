const t="___capture-show",e="___force-overflow",n={margin:{top:0,right:0,bottom:0,left:0},padding:{top:0,right:0,bottom:0,left:0},returnType:"dataUrl",targetNode:document.body};function r(n,r){!function(n){n.classList.add(t);let r=n.parentElement;for(;r;)r.classList.add(e),r=r.parentElement}(n);const o=function(){const n=document.head.cloneNode(!0),r=document.createElement("style");return r.innerText+=`body {transform: translateY(${window.outerHeight}px) !important; overflow: visible;}`,r.innerText+=`.${t} {transform: translateY(-${window.outerHeight}px) !important;}`,r.innerText+=`.${e} {overflow: visible !important;}`,n.appendChild(r),(new XMLSerializer).serializeToString(n)}(),i=(new XMLSerializer).serializeToString(document.body).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),a=-r.left,s=-r.top;let l="";return l+=`<svg xmlns="http://www.w3.org/2000/svg" width="${r.width}" height="${r.height}">`,l+=`<foreignObject x="${a}" y="${s}" width="${window.outerWidth}" height="${window.outerHeight}"><html xmlns="http://www.w3.org/1999/xhtml">${o}${i}</html></foreignObject>`,l+="</svg>",function(n){n.classList.remove(t);let r=n.parentElement;for(;r;)r.classList.remove(e),r=r.parentElement}(n),l}export default function(t){const e=Object.assign({},n,t).targetNode,o=e.getBoundingClientRect(),i=r(e,o),a=`data:image/svg+xml;base64,${btoa(i)}`,s=document.createElement("canvas");return new Promise((t,e)=>{if(s){const n=document.createElement("img");n.src=a,n.addEventListener("load",()=>{s.width=o.width,s.height=o.height,s.getContext("2d").drawImage(n,0,0),t(s.toDataURL())}),n.addEventListener("error",()=>{e()})}else e()})}