const e="___",t=`${e}capture-show`,n=`${e}capture-hide`,r=`${e}force-overflow`,i={customStyle:"",excludedNodes:[],returnType:"dataUrl",targetNode:document.body};let o=i;function s(e,i){!function(e){e.classList.add(t);let i=e.parentElement;for(const e of o.excludedNodes)e.classList.add(n);for(;i;)i.classList.add(r),i=i.parentElement}(e);const s=function(e){const i=document.head.cloneNode(!0),s=document.createElement("style");for(const e of Array.from(i.childNodes))e instanceof HTMLStyleElement||e.remove();s.innerText+="foreignObject>div {",s.innerText+="position: fixed;",s.innerText+=`top: ${window.outerHeight}px;`,s.innerText+="overflow: visible;",s.innerText+="}",s.innerText+=`.${t} {`,s.innerText+="position: fixed;",s.innerText+="left: 0;",s.innerText+="top: 0;",s.innerText+=`width: ${e.width}px;`,s.innerText+=`height: ${e.height}px;`,s.innerText+="}",s.innerText+=`.${n} {display: none !important;}`,s.innerText+=`.${r} {overflow: visible !important;}`,s.innerText+=o.customStyle,i.appendChild(s);let d="";for(const e of Array.from(i.querySelectorAll("style")))d+=e.outerHTML;return d}(i),d=document.body.innerHTML.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g,"");i.left,i.top;const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("height",i.height.toString()),c.setAttribute("width",i.width.toString());const l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.removeAttribute("xmlns"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("height",window.outerHeight.toString()),l.setAttribute("width",window.outerWidth.toString());const a=document.createElement("div");a.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("class",document.body.className),a.innerHTML=d,l.appendChild(a),c.insertAdjacentHTML("afterbegin",s),c.appendChild(l),function(e){e.classList.remove(t);let i=e.parentElement;for(const e of o.excludedNodes)e.classList.remove(n);for(;i;)i.classList.remove(r),i=i.parentElement}(e);return(new XMLSerializer).serializeToString(c)}function d(e){o=Object.assign(Object.assign({},i),e);const t=o.targetNode,n=t.getBoundingClientRect(),r=s(t,n),d=`data:image/svg+xml,${encodeURIComponent(r)}`,c=document.createElement("canvas");return new Promise(((e,t)=>{if(!c)return void t();const r=document.createElement("img");r.addEventListener("error",(()=>{c.remove(),t()})),r.addEventListener("load",(()=>{c.width=n.width,c.height=n.height;c.getContext("2d").drawImage(r,0,0),e(c.toDataURL()),c.remove()})),r.src=d}))}export{d as default};