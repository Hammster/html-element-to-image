const e="___capture-show",t="___capture-hide",n="___force-overflow",o={excludedNodes:[],margin:{top:0,right:0,bottom:0,left:0},padding:{top:0,right:0,bottom:0,left:0},returnType:"dataUrl",targetNode:document.body};let r=o;function i(o,i){!function(o){o.classList.add(e);let i=o.parentElement;for(const e of r.excludedNodes)e.classList.add(t);for(;i;)i.classList.add(n),i=i.parentElement}(o);const a=function(){const o=document.head.cloneNode(!0),r=document.createElement("style");return r.innerText+=`body {transform: translateY(${window.outerHeight}px) !important; overflow: visible;}`,r.innerText+=`.${e} {transform: translateY(-${window.outerHeight}px) !important;}`,r.innerText+=`.${t} {display: none !important;}`,r.innerText+=`.${n} {overflow: visible !important;}`,o.appendChild(r),(new XMLSerializer).serializeToString(o)}(),s=(new XMLSerializer).serializeToString(document.body).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),d=-i.left,l=-i.top;let c="";return c+=`<svg xmlns="http://www.w3.org/2000/svg" width="${i.width}" height="${i.height}">`,c+=`<foreignObject x="${d}" y="${l}" width="${window.outerWidth}" height="${window.outerHeight}"><html xmlns="http://www.w3.org/1999/xhtml">${a}${s}</html></foreignObject>`,c+="</svg>",function(o){o.classList.remove(e);let i=o.parentElement;for(const e of r.excludedNodes)e.classList.remove(t);for(;i;)i.classList.remove(n),i=i.parentElement}(o),c}export default function(e){const t=(r=Object.assign({},o,e)).targetNode,n=t.getBoundingClientRect(),a=i(t,n),s=`data:image/svg+xml;base64,${btoa(a)}`,d=document.createElement("canvas");return new Promise((e,t)=>{if(d){const o=document.createElement("img");o.src=s,o.addEventListener("load",()=>{d.width=n.width,d.height=n.height,d.getContext("2d").drawImage(o,0,0),e(d.toDataURL())}),o.addEventListener("error",()=>{t()})}else t()})}