const e="___capture-show",t="___capture-hide",o="___force-overflow",n={excludedNodes:[],margin:{top:0,right:0,bottom:0,left:0},padding:{top:0,right:0,bottom:0,left:0},returnType:"dataUrl",targetNode:document.body};let r=n;function i(n,i){!function(n){n.classList.add(e);let i=n.parentElement;for(const e of r.excludedNodes)e.classList.add(t);for(;i;)i.classList.add(o),i=i.parentElement}(n);const a=function(){const t=document.head.cloneNode(!0),n=document.createElement("style");return n.innerText+=`body {transform: translateY(${window.outerHeight}px) !important; overflow: visible;}`,n.innerText+=`.${e} {transform: translateY(-${window.outerHeight}px) !important;}`,n.innerText+=`.${o} {overflow: visible !important;}`,t.appendChild(n),(new XMLSerializer).serializeToString(t)}(),s=(new XMLSerializer).serializeToString(document.body).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),d=-i.left,l=-i.top;let c="";return c+=`<svg xmlns="http://www.w3.org/2000/svg" width="${i.width}" height="${i.height}">`,c+=`<foreignObject x="${d}" y="${l}" width="${window.outerWidth}" height="${window.outerHeight}"><html xmlns="http://www.w3.org/1999/xhtml">${a}${s}</html></foreignObject>`,c+="</svg>",function(n){n.classList.remove(e);let i=n.parentElement;for(const e of r.excludedNodes)e.classList.remove(t);for(;i;)i.classList.remove(o),i=i.parentElement}(n),c}export default function(e){const t=(r=Object.assign({},n,e)).targetNode,o=t.getBoundingClientRect(),a=i(t,o),s=`data:image/svg+xml;base64,${btoa(a)}`,d=document.createElement("canvas");return new Promise((e,t)=>{if(d){const n=document.createElement("img");n.src=s,n.addEventListener("load",()=>{d.width=o.width,d.height=o.height,d.getContext("2d").drawImage(n,0,0),e(d.toDataURL())}),n.addEventListener("error",()=>{t()})}else t()})}