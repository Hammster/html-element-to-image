const e="___capture-show",t="___capture-hide",n="___force-overflow",r={customStyle:"",excludedNodes:[],returnType:"dataUrl",targetNode:document.body};let i=r;function o(r,o){!function(r){r.classList.add(e);let o=r.parentElement;for(const e of i.excludedNodes)e.classList.add(t);for(;o;)o.classList.add(n),o=o.parentElement}(r);const s=function(r){const o=document.head.cloneNode(!0),s=document.createElement("style");for(const e of Array.from(o.childNodes))e instanceof HTMLStyleElement||e.remove();s.innerText+="foreignObject>div {",s.innerText+="position: fixed;",s.innerText+=`top: ${window.outerHeight}px;`,s.innerText+="overflow: visible;",s.innerText+="}",s.innerText+=`.${e} {`,s.innerText+="position: fixed;",s.innerText+="left: 0;",s.innerText+="top: 0;",s.innerText+=`width: ${r.width}px;`,s.innerText+=`height: ${r.height}px;`,s.innerText+="}",s.innerText+=`.${t} {display: none !important;}`,s.innerText+=`.${n} {overflow: visible !important;}`,s.innerText+=i.customStyle,o.appendChild(s);let d="";for(const e of Array.from(o.querySelectorAll("style")))d+=e.outerHTML;return d}(o),d=document.body.innerHTML.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g,""),c=(o.left,o.top,document.createElementNS("http://www.w3.org/2000/svg","svg"));c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("height",o.height.toString()),c.setAttribute("width",o.width.toString());const l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.removeAttribute("xmlns"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("height",window.outerHeight.toString()),l.setAttribute("width",window.outerWidth.toString());const a=document.createElement("div");return a.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("class",document.body.className),a.innerHTML=d,l.appendChild(a),c.insertAdjacentHTML("afterbegin",s),c.appendChild(l),function(r){r.classList.remove(e);let o=r.parentElement;for(const e of i.excludedNodes)e.classList.remove(t);for(;o;)o.classList.remove(n),o=o.parentElement}(r),(new XMLSerializer).serializeToString(c)}function s(e){const t=(i=Object.assign(Object.assign({},r),e)).targetNode,n=t.getBoundingClientRect(),s=o(t,n),d=`data:image/svg+xml;base64,${btoa(s)}`,c=document.createElement("canvas");return new Promise((e,t)=>{if(!c)return void t();const r=document.createElement("img");r.addEventListener("error",()=>{c.remove(),t()}),r.addEventListener("load",()=>{c.width=n.width,c.height=n.height,c.getContext("2d").drawImage(r,0,0),e(c.toDataURL()),c.remove()}),r.src=d})}export{s as NodeToDataURL};