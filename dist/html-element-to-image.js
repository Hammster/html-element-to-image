"use strict";const a="___",l=`${a}capture-show`,m=`${a}capture-hide`,u=`${a}force-overflow`,h={customStyle:"",excludedNodes:[],returnType:"dataUrl",targetNode:document.body};let c=h;function p(n){n.classList.add(l);let t=n.parentElement;for(const e of c.excludedNodes)e.classList.add(m);for(;t;)t.classList.add(u),t=t.parentElement}function x(n){n.classList.remove(l);let t=n.parentElement;for(const e of c.excludedNodes)e.classList.remove(m);for(;t;)t.classList.remove(u),t=t.parentElement}function f(n){const t=document.head.cloneNode(!0),e=document.createElement("style");for(const o of Array.from(t.childNodes))o instanceof HTMLStyleElement||o.remove();e.innerText+="foreignObject>div {",e.innerText+="position: fixed;",e.innerText+=`top: ${window.outerHeight}px;`,e.innerText+="overflow: visible;",e.innerText+="}",e.innerText+=`.${l} {`,e.innerText+="position: fixed;",e.innerText+="left: 0;",e.innerText+="top: 0;",e.innerText+=`width: ${n.width}px;`,e.innerText+=`height: ${n.height}px;`,e.innerText+="}",e.innerText+=`.${m} {display: none !important;}`,e.innerText+=`.${u} {overflow: visible !important;}`,e.innerText+=c.customStyle,t.appendChild(e);let i="";for(const o of Array.from(t.querySelectorAll("style")))i+=o.outerHTML;return i}function v(){return document.body.innerHTML.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g,"")}function T(n,t){p(n);const e=f(t),i=v();-t.left,-t.top;const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("height",t.height.toString()),o.setAttribute("width",t.width.toString());const s=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");s.removeAttribute("xmlns"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("height",window.outerHeight.toString()),s.setAttribute("width",window.outerWidth.toString());const r=document.createElement("div");return r.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),r.setAttribute("class",document.body.className),r.innerHTML=i,s.appendChild(r),o.insertAdjacentHTML("afterbegin",e),o.appendChild(s),x(n),new XMLSerializer().serializeToString(o)}function b(n){c={...h,...n};const t=c.targetNode,e=t.getBoundingClientRect(),i=T(t,e),s=`data:image/svg+xml,${encodeURIComponent(i)}`,r=document.createElement("canvas");return new Promise((g,w)=>{if(!r){w();return}const d=document.createElement("img");d.addEventListener("error",()=>{r.remove(),w()}),d.addEventListener("load",()=>{r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(d,0,0),g(r.toDataURL()),r.remove()}),d.src=s})}module.exports=b;
